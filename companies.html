<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Companies — Greenfield Partners</title>
    <meta name="description" content="Explore Greenfield Partners' portfolio of high-growth companies across AI infrastructure, cybersecurity, deep tech, defense, fintech, and more.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollToPlugin.min.js"></script>

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="companies.css">

</head>
<body class="companies-body">

    <!-- NAVIGATION -->
    <header class="nav nav-companies" id="nav">
        <div class="nav-inner">
            <a href="index.html" class="nav-logo" aria-label="Greenfield Partners Home">
                <svg width="156" height="32" viewBox="0 0 156 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M25.0404 4.8001V4.2751C25.0404 4.1751 24.972 4.1001 24.8808 4.1001H3.89987C3.80865 4.1001 3.74023 4.1751 3.74023 4.2751V27.5251C3.74023 27.6001 3.78585 27.6751 3.83146 27.7001C3.85426 27.7001 3.87707 27.7001 3.89987 27.7001C3.94548 27.7001 25.0632 27.7001 25.1088 27.7001C25.1316 27.7001 25.1544 27.7001 25.1772 27.7001C25.2457 27.6751 25.2685 27.6001 25.2685 27.5251V15.5001C25.2685 15.4001 25.2001 15.3251 25.1088 15.3251H24.6299C24.5387 15.3251 24.4703 15.4001 24.4703 15.5001V26.8751H4.56123V4.9751H24.9036C24.972 4.9751 25.0404 4.9001 25.0404 4.8001Z" fill="white"/>
                    <path d="M8.27866 9.0752H21.1409C21.2321 9.0752 21.3006 9.00022 21.3006 8.90022V8.37522C21.3006 8.27522 21.2321 8.2002 21.1409 8.2002H7.64011C7.54889 8.2002 7.48047 8.27522 7.48047 8.37522V23.4502C7.48047 23.5252 7.52608 23.6002 7.57169 23.6252C7.5945 23.6252 7.6173 23.6252 7.64011 23.6252C7.68572 23.6252 21.3462 23.6252 21.3918 23.6252C21.4146 23.6252 21.4374 23.6252 21.4602 23.6252C21.5286 23.6002 21.5514 23.5252 21.5514 23.4502V15.4752C21.5514 15.3752 21.483 15.3002 21.3918 15.3002H20.9129C20.8216 15.3002 20.7532 15.3752 20.7532 15.4752V22.8002H8.27866V9.0752Z" fill="white"/>
                    <path d="M28.8489 15.3H28.3699C28.2787 15.3 28.2103 15.375 28.2103 15.475V30.975H0.79819V0.875H28.598C28.6892 0.875 28.7576 0.799998 28.7576 0.699998V0.175003C28.7576 0.075003 28.6892 0 28.598 0H0.159637C0.0684156 0 0 0.075003 0 0.175003V31.625C0 31.7 0.0456095 31.775 0.0912203 31.8C0.114026 31.8 0.136832 31.8 0.159637 31.8C0.205248 31.8 28.8033 31.8 28.8489 31.8C28.8717 31.8 28.8945 31.8 28.9173 31.8C28.9857 31.775 29.0085 31.7 29.0085 31.625V15.475C29.0085 15.375 28.9401 15.3 28.8489 15.3Z" fill="white"/>
                    <path d="M48.3932 15.905H52.6578V16.63C52.6578 19.48 51.1754 21.355 48.6212 21.355C45.8618 21.355 44.1514 19.18 44.1514 16.43C44.1514 13.655 45.9074 11.48 48.6668 11.48C50.879 11.48 51.8596 12.705 51.8596 12.705L51.1526 13.705C51.1526 13.705 50.2404 12.705 48.6668 12.705C46.6372 12.705 45.3601 14.355 45.3601 16.43C45.3601 18.48 46.5687 20.13 48.5984 20.13C50.286 20.13 51.4035 18.93 51.4491 17.18V17.055H48.416V15.905H48.3932Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M64.721 14.8801C64.721 16.3801 63.9685 17.3801 62.7826 17.8301V17.9051L65.0175 20.9051V21.1551H63.7176L61.4599 18.0801H58.8372V21.1551H57.6514V11.7051H61.2546C63.3983 11.7051 64.721 12.8301 64.721 14.8801ZM61.2318 12.8801H58.8372V16.9051H61.3458C62.6001 16.9051 63.4896 16.2801 63.4896 14.9051C63.4896 13.5551 62.6001 12.8801 61.2318 12.8801Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M75.7818 17.0552H71.2435V19.9552H76.4659V21.1302H70.0576V11.6802H76.4659V12.8552H71.2435V15.8802H75.7818V17.0552Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M87.5718 17.0549H83.0335V19.9549H88.256V21.1299H81.8477V11.6799H88.256V12.8549H83.0335V15.8799H87.5718V17.0549Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M101.209 21.1551H100.89L94.7777 14.3801V21.1551H93.5918V11.7051H93.9111L100 18.4051V11.7051H101.186V21.1551H101.209Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M106.661 11.7051H113.069V12.8801H107.847V15.9051H112.431V17.0551H107.847V21.1551H106.661V11.7051Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M119.18 21.1551H117.994V11.7051H119.18V21.1551Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M130.104 17.0552H125.566V19.9552H130.788V21.1302H124.38V11.6802H130.788V12.8552H125.566V15.8802H130.104V17.0552Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M136.011 21.1551V11.7051H137.197V19.9551H142.123V21.1301H136.011V21.1551Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                    <path d="M150.059 21.1551H146.98V11.7051H150.059C152.796 11.7051 154.643 13.5551 154.643 16.4301C154.643 19.3051 152.819 21.1551 150.059 21.1551ZM148.166 12.8801V19.9551H149.991C151.952 19.9551 153.457 18.6551 153.457 16.4051C153.457 14.1551 151.975 12.8551 149.991 12.8551H148.166V12.8801Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                </svg>
            </a>

            <nav class="nav-links" id="navLinks">
                <a href="companies.html" class="nav-link nav-link-active">Companies</a>
                <a href="g2m.html" class="nav-link">G<sup>2</sup>M</a>
                <a href="approach.html" class="nav-link">Approach</a>
                <a href="#" class="nav-link">Team</a>
                <a href="#" class="nav-link">Knowledge</a>
                <a href="#" class="nav-link">Careers</a>
            </nav>

            <div class="nav-actions">
                <a href="#follow" class="btn-cta">
                    <span class="btn-cta-text">Follow Us</span>
                    <span class="btn-cta-icon">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                            <path d="M1 13L13 1M13 1H3M13 1V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </span>
                </a>
                <button class="nav-hamburger" id="navHamburger" aria-label="Toggle menu">
                    <span></span><span></span><span></span>
                </button>
            </div>
        </div>
    </header>

    <!-- MOBILE MENU OVERLAY -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-inner">
            <a href="companies.html" class="mobile-menu-link">Companies</a>
            <a href="g2m.html" class="mobile-menu-link">G<sup>2</sup>M</a>
            <a href="approach.html" class="mobile-menu-link">Approach</a>
            <a href="#" class="mobile-menu-link">Team</a>
            <a href="#" class="mobile-menu-link">Knowledge</a>
            <a href="#" class="mobile-menu-link">Careers</a>
        </div>
    </div>

    <main class="companies-main">

        <!-- ── PAGE HEADER ── -->
        <div class="companies-banner">
            <div class="companies-banner-text">
                <div class="companies-banner-headline-wrap">
                    <h1 class="companies-banner-headline">Hungry<span class="companies-banner-comma">,</span> Humble<span class="companies-banner-comma">,</span> Smart</h1>
                    <p class="companies-banner-tagline">In that specific order</p>
                    <p class="companies-banner-sub">Our Companies</p>
                </div>
            </div>
        </div>

        <!-- ── FILTER BAR ── -->
        <section class="companies-filters">
            <div class="companies-filters-inner">
                <div class="companies-filter-top">

                    <!-- Row 1: Sector filters -->
                    <div class="companies-filter-row">
                        <span class="companies-filter-label">Sector</span>
                        <button class="filter-pill filter-pill--active" data-filter="sector" data-value="all">All</button>
                        <button class="filter-pill" data-filter="sector" data-value="ai-infra">AI Infrastructure</button>
                        <button class="filter-pill" data-filter="sector" data-value="cybersecurity">Cybersecurity</button>
                        <button class="filter-pill" data-filter="sector" data-value="deep-tech">Deep Tech</button>
                        <button class="filter-pill" data-filter="sector" data-value="defense">Defense</button>
                        <button class="filter-pill" data-filter="sector" data-value="fintech">Fintech</button>
                        <button class="filter-pill" data-filter="sector" data-value="internet">Internet / Digital Media</button>
                        <button class="filter-pill" data-filter="sector" data-value="it-infra">IT Infrastructure</button>
                        <button class="filter-pill" data-filter="sector" data-value="vertical-ai">Vertical AI</button>
                    </div>

                    <!-- Row 2: Status filters + Grid/List toggle -->
                    <div class="companies-filter-row">
                        <span class="companies-filter-label">Status</span>
                        <button class="filter-pill filter-pill--active" data-filter="status" data-value="all">All</button>
                        <button class="filter-pill" data-filter="status" data-value="active">Active</button>
                        <button class="filter-pill" data-filter="status" data-value="exited">Exited</button>

                        <!-- Grid / List toggle -->
                        <div class="view-toggle" id="viewToggle">
                            <button class="view-toggle-btn view-toggle-btn--active" data-view="grid" aria-label="Grid view">
                                <svg viewBox="0 0 16 16" fill="none"><rect x="1" y="1" width="6" height="6" rx="1" fill="currentColor"/><rect x="9" y="1" width="6" height="6" rx="1" fill="currentColor"/><rect x="1" y="9" width="6" height="6" rx="1" fill="currentColor"/><rect x="9" y="9" width="6" height="6" rx="1" fill="currentColor"/></svg>
                            </button>
                            <button class="view-toggle-btn" data-view="list" aria-label="List view">
                                <svg viewBox="0 0 16 16" fill="none"><rect x="1" y="2" width="14" height="2.5" rx="0.75" fill="currentColor"/><rect x="1" y="6.75" width="14" height="2.5" rx="0.75" fill="currentColor"/><rect x="1" y="11.5" width="14" height="2.5" rx="0.75" fill="currentColor"/></svg>
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ── PORTFOLIO GRID + LIST ── -->
        <section class="companies-portfolio">
            <div class="companies-portfolio-inner">
                <div class="companies-grid view-active" id="companiesGrid">
                    <!-- JS-populated -->
                </div>
                <div class="companies-list" id="companiesList">
                    <!-- JS-populated -->
                </div>
            </div>
        </section>

    </main>

    <!-- ── SITE FOOTER ── -->
    <footer class="site-footer" id="footer">
        <!-- Full background image -->
        <div class="footer-bg-image" style="background-image: url('assets/images/footer.png')"></div>
        <div class="footer-bg-overlay"></div>

        <!-- All footer content -->
        <div class="footer-content">

            <!-- Subscribe CTA -->
            <div class="footer-cta">
                <h2 class="footer-cta-title">Keep Pace with Greenfield Partners</h2>
                <form class="footer-cta-form" onsubmit="return false;">
                    <div class="footer-cta-fields">
                        <input type="text" class="footer-cta-input" placeholder="Full Name" aria-label="Full Name">
                        <input type="email" class="footer-cta-input" placeholder="Email" aria-label="Email">
                    </div>
                    <button type="submit" class="footer-cta-btn">
                        <span>Subscribe</span>
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                            <path d="M1 13L13 1M13 1H3M13 1V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </form>
            </div>

            <!-- Logo + Nav -->
            <div class="footer-mid">
                <div class="footer-logo">
                    <a href="index.html" aria-label="Greenfield Partners Home">
                        <svg width="200" height="42" viewBox="0 0 156 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M25.0404 4.8001V4.2751C25.0404 4.1751 24.972 4.1001 24.8808 4.1001H3.89987C3.80865 4.1001 3.74023 4.1751 3.74023 4.2751V27.5251C3.74023 27.6001 3.78585 27.6751 3.83146 27.7001C3.85426 27.7001 3.87707 27.7001 3.89987 27.7001C3.94548 27.7001 25.0632 27.7001 25.1088 27.7001C25.1316 27.7001 25.1544 27.7001 25.1772 27.7001C25.2457 27.6751 25.2685 27.6001 25.2685 27.5251V15.5001C25.2685 15.4001 25.2001 15.3251 25.1088 15.3251H24.6299C24.5387 15.3251 24.4703 15.4001 24.4703 15.5001V26.8751H4.56123V4.9751H24.9036C24.972 4.9751 25.0404 4.9001 25.0404 4.8001Z" fill="white"/>
                            <path d="M8.27866 9.0752H21.1409C21.2321 9.0752 21.3006 9.00022 21.3006 8.90022V8.37522C21.3006 8.27522 21.2321 8.2002 21.1409 8.2002H7.64011C7.54889 8.2002 7.48047 8.27522 7.48047 8.37522V23.4502C7.48047 23.5252 7.52608 23.6002 7.57169 23.6252C7.5945 23.6252 7.6173 23.6252 7.64011 23.6252C7.68572 23.6252 21.3462 23.6252 21.3918 23.6252C21.4146 23.6252 21.4374 23.6252 21.4602 23.6252C21.5286 23.6002 21.5514 23.5252 21.5514 23.4502V15.4752C21.5514 15.3752 21.483 15.3002 21.3918 15.3002H20.9129C20.8216 15.3002 20.7532 15.3752 20.7532 15.4752V22.8002H8.27866V9.0752Z" fill="white"/>
                            <path d="M28.8489 15.3H28.3699C28.2787 15.3 28.2103 15.375 28.2103 15.475V30.975H0.79819V0.875H28.598C28.6892 0.875 28.7576 0.799998 28.7576 0.699998V0.175003C28.7576 0.075003 28.6892 0 28.598 0H0.159637C0.0684156 0 0 0.075003 0 0.175003V31.625C0 31.7 0.0456095 31.775 0.0912203 31.8C0.114026 31.8 0.136832 31.8 0.159637 31.8C0.205248 31.8 28.8033 31.8 28.8489 31.8C28.8717 31.8 28.8945 31.8 28.9173 31.8C28.9857 31.775 29.0085 31.7 29.0085 31.625V15.475C29.0085 15.375 28.9401 15.3 28.8489 15.3Z" fill="white"/>
                            <path d="M48.3932 15.905H52.6578V16.63C52.6578 19.48 51.1754 21.355 48.6212 21.355C45.8618 21.355 44.1514 19.18 44.1514 16.43C44.1514 13.655 45.9074 11.48 48.6668 11.48C50.879 11.48 51.8596 12.705 51.8596 12.705L51.1526 13.705C51.1526 13.705 50.2404 12.705 48.6668 12.705C46.6372 12.705 45.3601 14.355 45.3601 16.43C45.3601 18.48 46.5687 20.13 48.5984 20.13C50.286 20.13 51.4035 18.93 51.4491 17.18V17.055H48.416V15.905H48.3932Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M64.721 14.8801C64.721 16.3801 63.9685 17.3801 62.7826 17.8301V17.9051L65.0175 20.9051V21.1551H63.7176L61.4599 18.0801H58.8372V21.1551H57.6514V11.7051H61.2546C63.3983 11.7051 64.721 12.8301 64.721 14.8801ZM61.2318 12.8801H58.8372V16.9051H61.3458C62.6001 16.9051 63.4896 16.2801 63.4896 14.9051C63.4896 13.5551 62.6001 12.8801 61.2318 12.8801Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M75.7818 17.0552H71.2435V19.9552H76.4659V21.1302H70.0576V11.6802H76.4659V12.8552H71.2435V15.8802H75.7818V17.0552Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M87.5718 17.0549H83.0335V19.9549H88.256V21.1299H81.8477V11.6799H88.256V12.8549H83.0335V15.8799H87.5718V17.0549Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M101.209 21.1551H100.89L94.7777 14.3801V21.1551H93.5918V11.7051H93.9111L100 18.4051V11.7051H101.186V21.1551H101.209Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M106.661 11.7051H113.069V12.8801H107.847V15.9051H112.431V17.0551H107.847V21.1551H106.661V11.7051Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M119.18 21.1551H117.994V11.7051H119.18V21.1551Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M130.104 17.0552H125.566V19.9552H130.788V21.1302H124.38V11.6802H130.788V12.8552H125.566V15.8802H130.104V17.0552Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M136.011 21.1551V11.7051H137.197V19.9551H142.123V21.1301H136.011V21.1551Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                            <path d="M150.059 21.1551H146.98V11.7051H150.059C152.796 11.7051 154.643 13.5551 154.643 16.4301C154.643 19.3051 152.819 21.1551 150.059 21.1551ZM148.166 12.8801V19.9551H149.991C151.952 19.9551 153.457 18.6551 153.457 16.4051C153.457 14.1551 151.975 12.8551 149.991 12.8551H148.166V12.8801Z" fill="white" stroke="white" stroke-width="0.461047" stroke-miterlimit="10"/>
                        </svg>
                    </a>
                </div>

                <nav class="footer-nav">
                    <a href="index.html" class="footer-nav-link">Home</a>
                    <a href="approach.html" class="footer-nav-link">Approach</a>
                    <a href="g2m.html" class="footer-nav-link">G<sup>2</sup>M</a>
                    <a href="companies.html" class="footer-nav-link">Companies</a>
                    <a href="#" class="footer-nav-link">Team</a>
                    <a href="#" class="footer-nav-link">Knowledge</a>
                    <a href="#" class="footer-nav-link">Careers</a>
                </nav>
            </div>

            <!-- Addresses & Contact -->
            <div class="footer-addresses">
                <div class="footer-address">
                    <span class="footer-address-label">New York</span>
                    <p class="footer-address-text">200 Park Avenue South, New York<br>Suite 403</p>
                </div>
                <div class="footer-address">
                    <span class="footer-address-label">Israel</span>
                    <p class="footer-address-text">144 Menachem Begin Road, Tel Aviv<br>Midtown Tower</p>
                </div>
                <div class="footer-address">
                    <span class="footer-address-label">Contact</span>
                    <a href="mailto:info@greenfield-growth.com" class="footer-email">info@greenfield-growth.com</a>
                </div>
            </div>

            <!-- Divider -->
            <div class="footer-divider"></div>

            <!-- Bottom Bar -->
            <div class="footer-bottom">
                <p class="footer-copyright">&copy; Greenfield Partners. All rights reserved.</p>
                <div class="footer-legal">
                    <a href="#" class="footer-legal-link">Privacy Policy</a>
                    <a href="#" class="footer-legal-link">Terms of Service</a>
                </div>
            </div>

        </div>
    </footer>

    <script src="portfolio-data.js"></script>
    <script src="dashboard.js"></script>
    <script>
    // ── Companies Page — Filter, Grid/List Toggle & Render ───────
    (function () {
        'use strict';

        // ── State ──
        var activeSector = 'all';
        var activeStatus = 'all';
        var activeView = 'grid';  // 'grid' | 'list'
        var expandedCompanyId = null;

        // Sort portfolio alphabetically by name
        var sorted = PORTFOLIO.slice().sort(function (a, b) {
            return a.name.localeCompare(b.name);
        });

        // Category → display label mapping
        var categoryLabels = {
            'ai-infra': 'AI Infrastructure',
            'aai': 'AI Infrastructure',
            'cybersecurity': 'Cybersecurity',
            'deep-tech': 'Deep Tech',
            'defense': 'Defense',
            'fintech': 'Fintech',
            'internet': 'Internet / Digital Media',
            'it-infra': 'IT Infrastructure',
            'vertical-ai': 'Vertical AI'
        };

        var grid = document.getElementById('companiesGrid');
        var list = document.getElementById('companiesList');
        var arrowSVG = '<svg width="12" height="12" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1M13 1H3M13 1V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>';

        // ── Filter helper ──
        function getFiltered() {
            return sorted.filter(function (c) {
                var sectorMatch = activeSector === 'all' || c.category === activeSector || (activeSector === 'ai-infra' && c.category === 'aai');
                var statusMatch = activeStatus === 'all' || c.status === activeStatus;
                return sectorMatch && statusMatch;
            });
        }

        // ── Build grid card ──
        function buildCard(company) {
            var featuredClass = company.featured ? ' bento-card-featured' : '';
            var sectorLabel = categoryLabels[company.category] || company.sector;
            // Strip <br> tags for grid card description
            var desc = company.description.replace(/<br\s*\/?>/gi, ' ');
            var exitedBadge = company.status === 'exited' ? '<span class="bento-card-exited-badge">Exited</span>' : '';

            return '<div class="bento-card' + featuredClass + '" data-category="' + company.category + '" data-company-id="' + company.id + '">' +
                '<div class="bento-card-bg bento-card-bg-img" style="background-image: url(\'' + company.bg + '\')"></div>' +
                '<div class="bento-card-bg-overlay"></div>' +
                '<div class="bento-card-glow"></div>' +
                exitedBadge +
                '<div class="bento-card-content">' +
                    '<div class="bento-card-top">' +
                        '<div class="bento-card-icon">' +
                            '<img src="' + company.favicon + '" alt="' + company.name + '" class="bento-card-logo-img">' +
                        '</div>' +
                        '<span class="bento-card-tag">' + sectorLabel + '</span>' +
                    '</div>' +
                    '<div class="bento-card-bottom">' +
                        '<h3 class="bento-card-name">' + company.name + '</h3>' +
                        '<p class="bento-card-desc">' + desc + '</p>' +
                        '<div class="bento-card-meta">' +
                            '<span class="bento-card-stage">' + company.round + '</span>' +
                            '<span class="bento-card-divider">&middot;</span>' +
                            '<span class="bento-card-location">' + company.year + '</span>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                '<div class="bento-card-hover-line"></div>' +
            '</div>';
        }

        // ── Build list row ──
        function buildRow(company) {
            var sectorLabel = categoryLabels[company.category] || company.sector;
            var desc = company.description.replace(/<br\s*\/?>/gi, ' ');
            var exitedBadge = company.status === 'exited' ? '<span class="list-exited-badge">Exited</span>' : '';
            var ceo = company.ceo || '';
            var partnered = company.round + ' | ' + company.year;
            var websiteUrl = company.website || '#';
            var logoSrc = company.logo || company.favicon;

            return '<div class="list-row" data-company-id="' + company.id + '">' +
                '<div class="list-logo">' +
                    '<img src="' + logoSrc + '" alt="' + company.name + '" class="list-logo-img">' +
                    exitedBadge +
                '</div>' +
                '<span class="list-sector">' + sectorLabel + '</span>' +
                '<span class="list-description">' + desc + '</span>' +
                '<span class="list-ceo">' + ceo + '</span>' +
                '<span class="list-partnered">' + partnered + '</span>' +
                '<a href="' + websiteUrl + '" target="_blank" rel="noopener" class="list-website">Visit ' + arrowSVG + '</a>' +
            '</div>';
        }

        // ── Build expand panel HTML ──
        function buildExpandPanel(company) {
            var sectorLabel = categoryLabels[company.category] || company.sector;
            var logoSrc = company.logoWhite || company.favicon;
            var statusDot = company.status === 'active'
                ? '<span class="expand-status-dot active"></span>Active'
                : '<span class="expand-status-dot exited"></span>' + (company.exitLabel || 'Exited');
            var ceo = company.ceo || '\u2014';
            var partnered = company.year || '\u2014';
            var websiteUrl = company.website || '#';
            var websiteDomain = websiteUrl.replace(/^https?:\/\//, '').replace(/\/$/, '');

            // Deal team pills
            var dealTeamHtml = '';
            if (company.dealTeam && company.dealTeam.length) {
                company.dealTeam.forEach(function (member) {
                    dealTeamHtml += '<span class="expand-deal-pill">' + member + '</span>';
                });
            }

            // Long description
            var longDesc = company.longDescription || company.description.replace(/<br\s*\/?>/gi, ' ');

            // Testimonial block
            var testimonialHtml = '';
            if (company.testimonial) {
                testimonialHtml =
                    '<div class="expand-testimonial">' +
                        '<div class="expand-testimonial-quote">\u201C' + company.testimonial.quote + '\u201D</div>' +
                        '<div class="expand-testimonial-author">\u2014 ' + company.testimonial.author + '</div>' +
                    '</div>';
            }

            return '<div class="expand-panel" data-company-id="' + company.id + '">' +
                '<div class="expand-panel-bg" style="background-image: url(\'' + company.bg + '\')"></div>' +
                '<div class="expand-panel-bg-overlay"></div>' +
                '<button class="expand-close" aria-label="Close">&times;</button>' +
                '<div class="expand-content">' +
                    '<div class="expand-left">' +
                        '<div class="expand-logo">' +
                            '<img src="' + logoSrc + '" alt="' + company.name + '">' +
                        '</div>' +
                        '<div class="expand-meta-grid">' +
                            '<div class="expand-meta-item"><span class="expand-meta-label">Sector</span><span class="expand-meta-value">' + sectorLabel + '</span></div>' +
                            '<div class="expand-meta-item"><span class="expand-meta-label">First Partnered</span><span class="expand-meta-value">' + partnered + '</span></div>' +
                            '<div class="expand-meta-item"><span class="expand-meta-label">CEO</span><span class="expand-meta-value">' + ceo + '</span></div>' +
                            '<div class="expand-meta-item"><span class="expand-meta-label">Status</span><span class="expand-meta-value">' + statusDot + '</span></div>' +
                        '</div>' +
                        (dealTeamHtml ? '<div class="expand-deal-team"><span class="expand-meta-label">Deal Team</span><div class="expand-deal-pills">' + dealTeamHtml + '</div></div>' : '') +
                    '</div>' +
                    '<div class="expand-right">' +
                        '<div class="expand-long-desc">' + longDesc + '</div>' +
                        testimonialHtml +
                        '<a href="' + websiteUrl + '" target="_blank" rel="noopener" class="expand-website-link">Visit ' + websiteDomain + ' <svg width="12" height="12" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1M13 1H3M13 1V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a>' +
                    '</div>' +
                '</div>' +
            '</div>';
        }

        // ── Animate panel open ──
        function animatePanelOpen(panel, skipDim) {
            var container = activeView === 'grid' ? grid : list;
            var selector = activeView === 'grid' ? '.bento-card' : '.list-row';
            var siblings = container.querySelectorAll(selector);
            var contentEls = panel.querySelectorAll('.expand-left > *, .expand-right > *');

            // Set initial state
            gsap.set(panel, { height: 0, overflow: 'hidden', opacity: 1 });
            gsap.set(contentEls, { opacity: 0, y: 14 });

            var tl = gsap.timeline({
                onComplete: function () {
                    panel.style.height = 'auto';
                }
            });

            // Step 1: Gentle dim — cards stay visually "there" and clickable
            if (!skipDim) {
                tl.to(siblings, {
                    opacity: 0.55,
                    duration: 0.4,
                    ease: 'power1.out'
                }, 0);
            }

            // Step 2: Expand panel height
            tl.to(panel, {
                height: 'auto',
                duration: 0.5,
                ease: 'power3.out'
            }, 0.08);

            // Step 3: Content fades in
            tl.to(contentEls, {
                opacity: 1,
                y: 0,
                duration: 0.4,
                stagger: 0.04,
                ease: 'power2.out'
            }, 0.25);

            // Step 4: Scroll to panel
            tl.to(window, {
                scrollTo: { y: panel, offsetY: 120 },
                duration: 0.65,
                ease: 'power2.inOut'
            }, 0.2);
        }

        // ── Close expand panel (fast = true for quick swap between companies) ──
        function closeExpandPanel(callback, fast) {
            var panel = document.querySelector('.expand-panel');
            if (!panel) {
                expandedCompanyId = null;
                if (callback) callback();
                return;
            }

            var container = activeView === 'grid' ? grid : list;
            var selector = activeView === 'grid' ? '.bento-card' : '.list-row';
            var siblings = container.querySelectorAll(selector);
            var contentEls = panel.querySelectorAll('.expand-left > *, .expand-right > *');

            // Snap from auto to current pixel height so GSAP can animate to 0
            panel.style.height = panel.offsetHeight + 'px';
            panel.style.overflow = 'hidden';

            var tl = gsap.timeline({
                onComplete: function () {
                    if (panel.parentNode) panel.parentNode.removeChild(panel);
                    expandedCompanyId = null;
                    if (callback) callback();
                }
            });

            if (fast) {
                // Fast swap: skip content fade, just collapse quickly
                // Don't touch siblings — they stay dimmed for the new panel
                tl.to(panel, {
                    height: 0,
                    opacity: 0,
                    duration: 0.3,
                    ease: 'power2.inOut'
                }, 0);
            } else {
                // Normal close: full graceful animation
                tl.to(contentEls, {
                    opacity: 0,
                    y: -8,
                    duration: 0.2,
                    ease: 'power2.in'
                }, 0);

                tl.to(panel, {
                    height: 0,
                    duration: 0.4,
                    ease: 'power3.inOut'
                }, 0.1);

                tl.to(siblings, {
                    opacity: 1,
                    duration: 0.35,
                    ease: 'power1.out'
                }, 0.2);
            }
        }

        // ── Open expand panel ──
        function openExpandPanel(companyId) {
            // Find the company data
            var company = null;
            for (var i = 0; i < sorted.length; i++) {
                if (sorted[i].id === companyId) { company = sorted[i]; break; }
            }
            if (!company) return;

            // If same company is already open, close it
            if (expandedCompanyId === companyId) {
                closeExpandPanel(function () {
                    // Re-init glow after close
                    if (activeView === 'grid' && typeof initBentoGlow === 'function') initBentoGlow();
                });
                return;
            }

            // If a different panel is open, close it fast then open new
            if (expandedCompanyId !== null) {
                closeExpandPanel(function () {
                    doOpen(company, true);
                }, true);
                return;
            }

            doOpen(company, false);

            function doOpen(comp, isSwap) {
                expandedCompanyId = comp.id;
                var panelHtml = buildExpandPanel(comp);
                var container = activeView === 'grid' ? grid : list;

                if (activeView === 'grid') {
                    // Find the clicked card and its visual row
                    var cards = container.querySelectorAll('.bento-card');
                    var clickedCard = container.querySelector('.bento-card[data-company-id="' + comp.id + '"]');
                    if (!clickedCard) return;

                    var rowTop = clickedCard.offsetTop;
                    var lastInRow = clickedCard;

                    // Find last card in same visual row
                    for (var j = 0; j < cards.length; j++) {
                        if (cards[j].offsetTop === rowTop) {
                            lastInRow = cards[j];
                        }
                    }

                    // Insert panel after last card in row
                    lastInRow.insertAdjacentHTML('afterend', panelHtml);
                } else {
                    // List view: insert after clicked row
                    var clickedRow = container.querySelector('.list-row[data-company-id="' + comp.id + '"]');
                    if (!clickedRow) return;
                    clickedRow.insertAdjacentHTML('afterend', panelHtml);
                }

                var panel = container.querySelector('.expand-panel');

                // Close button handler
                panel.querySelector('.expand-close').addEventListener('click', function (e) {
                    e.stopPropagation();
                    closeExpandPanel(function () {
                        if (activeView === 'grid' && typeof initBentoGlow === 'function') initBentoGlow();
                    });
                });

                // Prevent clicks on links inside panel from closing
                panel.querySelectorAll('a').forEach(function (link) {
                    link.addEventListener('click', function (e) {
                        e.stopPropagation();
                    });
                });

                // Animate open — skip re-dimming siblings if swapping
                animatePanelOpen(panel, isSwap);
            }
        }

        // ── Render ──
        function render() {
            // Clean up any open panel
            expandedCompanyId = null;
            var existingPanel = document.querySelector('.expand-panel');
            if (existingPanel && existingPanel.parentNode) existingPanel.parentNode.removeChild(existingPanel);
            var filtered = getFiltered();

            if (filtered.length === 0) {
                grid.innerHTML = '<div class="companies-empty">No companies match the selected filters.</div>';
                list.innerHTML = '<div class="companies-empty">No companies match the selected filters.</div>';
                return;
            }

            // Grid
            var gridHtml = '';
            filtered.forEach(function (c) { gridHtml += buildCard(c); });
            grid.innerHTML = gridHtml;

            // List
            var listHtml = '<div class="list-header">' +
                '<span class="list-header-label">Company</span>' +
                '<span class="list-header-label">Sector</span>' +
                '<span class="list-header-label">About</span>' +
                '<span class="list-header-label">CEO</span>' +
                '<span class="list-header-label">First Partnered</span>' +
                '<span class="list-header-label">Website</span>' +
            '</div>';
            filtered.forEach(function (c) { listHtml += buildRow(c); });
            list.innerHTML = listHtml;

            // Re-init bento glow if grid is visible
            if (activeView === 'grid' && typeof initBentoGlow === 'function') {
                initBentoGlow();
            }

            // GSAP staggered entrance
            if (typeof gsap !== 'undefined') {
                if (activeView === 'grid') {
                    var cards = grid.querySelectorAll('.bento-card');
                    gsap.fromTo(cards,
                        { opacity: 0, y: 30 },
                        { opacity: 1, y: 0, duration: 0.45, stagger: 0.06, ease: 'power2.out' }
                    );
                } else {
                    var rows = list.querySelectorAll('.list-row');
                    gsap.fromTo(rows,
                        { opacity: 0, y: 16 },
                        { opacity: 1, y: 0, duration: 0.35, stagger: 0.04, ease: 'power2.out' }
                    );
                }
            }

            // ── Expand panel click handlers ──
            // Grid cards
            grid.querySelectorAll('.bento-card').forEach(function (card) {
                card.addEventListener('click', function (e) {
                    // Don't intercept clicks on existing links
                    if (e.target.closest('a')) return;
                    var id = card.getAttribute('data-company-id');
                    if (id) openExpandPanel(id);
                });
            });
            // List rows
            list.querySelectorAll('.list-row').forEach(function (row) {
                row.addEventListener('click', function (e) {
                    // Don't intercept clicks on existing links
                    if (e.target.closest('a')) return;
                    var id = row.getAttribute('data-company-id');
                    if (id) openExpandPanel(id);
                });
            });
        }

        // ── Toggle view ──
        function setView(view) {
            activeView = view;
            grid.classList.toggle('view-active', view === 'grid');
            list.classList.toggle('view-active', view === 'list');

            // Toggle button state
            document.querySelectorAll('.view-toggle-btn').forEach(function (btn) {
                btn.classList.toggle('view-toggle-btn--active', btn.getAttribute('data-view') === view);
            });

            // Re-render to trigger animations and glow
            render();
        }

        // ── View toggle click handler ──
        document.querySelectorAll('.view-toggle-btn').forEach(function (btn) {
            btn.addEventListener('click', function () {
                setView(this.getAttribute('data-view'));
            });
        });

        // ── Pill click handlers ──
        var pills = document.querySelectorAll('.filter-pill');
        pills.forEach(function (pill) {
            pill.addEventListener('click', function () {
                var filterGroup = this.getAttribute('data-filter');
                var value = this.getAttribute('data-value');

                pills.forEach(function (p) {
                    if (p.getAttribute('data-filter') === filterGroup) {
                        p.classList.remove('filter-pill--active');
                    }
                });

                this.classList.add('filter-pill--active');

                if (filterGroup === 'sector') {
                    activeSector = value;
                } else if (filterGroup === 'status') {
                    activeStatus = value;
                }

                render();
            });
        });

        // ── Hamburger menu toggle ──
        var hamburger = document.getElementById('navHamburger');
        var mobileMenu = document.getElementById('mobileMenu');
        if (hamburger && mobileMenu) {
            hamburger.addEventListener('click', function () {
                hamburger.classList.toggle('active');
                mobileMenu.classList.toggle('active');
            });
        }

        // ── Escape key to close panel ──
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && expandedCompanyId !== null) {
                closeExpandPanel(function () {
                    if (activeView === 'grid' && typeof initBentoGlow === 'function') initBentoGlow();
                });
            }
        });

        // ── Click outside to close panel ──
        document.addEventListener('click', function (e) {
            if (expandedCompanyId === null) return;
            // If click is inside the panel, ignore
            if (e.target.closest('.expand-panel')) return;
            // If click is on a card/row (which triggers openExpandPanel), ignore
            if (e.target.closest('.bento-card') || e.target.closest('.list-row')) return;
            // If click is on filter pills or toggle, ignore (render() handles cleanup)
            if (e.target.closest('.filter-pill') || e.target.closest('.view-toggle-btn')) return;
            // Otherwise close
            closeExpandPanel(function () {
                if (activeView === 'grid' && typeof initBentoGlow === 'function') initBentoGlow();
            });
        });

        // ── Initial render ──
        render();

    })();

    // ── Banner parallax ──
    (function () {
        var img    = document.querySelector('.companies-banner-img');
        var banner = document.querySelector('.companies-banner');
        if (!img || !banner) return;

        var ticking = false;

        function tick() {
            var sy = window.pageYOffset;
            // Only animate while banner is still in (or near) view
            if (sy < banner.offsetHeight * 2) {
                img.style.transform = 'translateY(' + Math.round(-sy * 0.28) + 'px)';
            }
            ticking = false;
        }

        window.addEventListener('scroll', function () {
            if (!ticking) {
                requestAnimationFrame(tick);
                ticking = true;
            }
        }, { passive: true });
    })();
    </script>
    <script src="nav-scroll.js"></script>

</body>
</html>
